generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [vector]
}

model Bot {
  id   String @id @default(uuid())
  slug String @unique

  name        String
  description String

  documents Document[]
  forms     Form[]
}

model Document {
  id String @id @default(uuid())

  botId String
  bot   Bot    @relation(fields: [botId], references: [id])

  name String

  content   String
  embedding Unsupported("vector")?
}

model Form {
  id String @id @default(uuid())

  botId String
  bot   Bot    @relation(fields: [botId], references: [id])

  description  String
  instructions String // prompt and details

  fields      Json
  submissions FormSubmission[]
}

model FormSubmission {
  id String @id @default(uuid())

  formId String
  form   Form   @relation(fields: [formId], references: [id])

  // Store the fields in the submission in case the fields changed
  fields      Json
  fieldValues Json
}
